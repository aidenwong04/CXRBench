# Adapted from SubpopBench (https://github.com/YyzHarry/SubpopBench).
# Linear probing config for CXR-CLIP ResNet50-M on MIMIC-CXR (multi-label).

model:
  checkpoint_path: /restricted/projectnb/batmanlab/ahcmwong/checkpoints/ResNet50-M/resnet50m_state.pt
  encoder: resnet50
  freeze_encoder: true
  image_size: 224
  mean: [0.485, 0.456, 0.406] # update to CXR-CLIP stats if they differ
  std: [0.229, 0.224, 0.225]
  classifier_dropout: 0.0

data:
  metadata_csv: /restricted/projectnb/batmanlab/ahcmwong/CXRBench/mimic-cxr-chexpert_scc.csv
  # Leave image_root empty if paths in the CSV are absolute. Otherwise set to the common prefix.
  image_root: ""
  path_column: path # column with relative paths
  label_columns:
    [
      "Cardiomegaly",
      "Atelectasis",
      "Consolidation",
      "Edema",
      "Enlarged Cardiomediastinum",
      "Fracture",
      "Lung Lesion",
      "Lung Opacity",
      "No Finding",
      "Pleural Effusion",
      "Pleural Other",
      "Pneumonia",
      "Pneumothorax",
      "Support Devices",
    ]
  split_column: split
  splits:
    train: train
    val: val
    test: test
  uncertain_policy: zero # map -1 -> 0
  num_workers: 8

training:
  batch_size: 32
  num_epochs: 10
  lr: 1e-3
  weight_decay: 1e-4
  optimizer: adam
  use_fp16: true

logging:
  output_dir: /restricted/projectnb/batmanlab/ahcmwong/outputs/classification/linear_probe/cxr_clip/ResNet50-M/
  log_every: 50
  eval_every: 1 # evaluate every N epochs
  save_ckpt: true
